{% extends "base.html" %}

{% block title %}–ó–∞–¥–∞—á–∏ - TeamManager{% endblock %}

{% block content %}
<div class="page-header">
    <h1>–ó–∞–¥–∞—á–∏</h1>
    <a href="/tasks/new" class="btn btn-primary">+ –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</a>
</div>

<div class="filters">
    <form action="/tasks" method="get" class="filter-form">
        <select name="status">
            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
            <option value="open" {% if status == 'open' %}selected{% endif %}>–û—Ç–∫—Ä—ã—Ç–∞</option>
            <option value="in_progress" {% if status == 'in_progress' %}selected{% endif %}>–í —Ä–∞–±–æ—Ç–µ</option>
            <option value="completed" {% if status == 'completed' %}selected{% endif %}>–ó–∞–≤–µ—Ä—à–µ–Ω–∞</option>
        </select>

        <select name="priority">
            <option value="">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
            <option value="low" {% if priority == 'low' %}selected{% endif %}>–ù–∏–∑–∫–∏–π</option>
            <option value="medium" {% if priority == 'medium' %}selected{% endif %}>–°—Ä–µ–¥–Ω–∏–π</option>
            <option value="high" {% if priority == 'high' %}selected{% endif %}>–í—ã—Å–æ–∫–∏–π</option>
            <option value="urgent" {% if priority == 'urgent' %}selected{% endif %}>–°—Ä–æ—á–Ω—ã–π</option>
        </select>

        <button type="submit" class="btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    </form>
</div>

<div class="task-list">
    {% if tasks %}
    {% for task in tasks %}
    <div class="task-item">
        <div class="task-info">
            <h3><a href="/tasks/{{ task.id }}">{{ task.title }}</a></h3>
            <p>{{ task.description[:150] }}{% if task.description|length > 150 %}...{% endif %}</p>
            <div class="task-meta">
                <span class="badge badge-{{ task.status.value }}">{{ task.status.value }}</span>
                <span class="badge badge-priority-{{ task.priority.value }}">{{ task.priority.value }}</span>
                {% if task.assignee %}
                <span>üë§ {{ task.assignee.first_name }} {{ task.assignee.last_name }}</span>
                {% endif %}
                {% if task.deadline %}
                <span>üìÖ {{ task.deadline.strftime('%d.%m.%Y') }}</span>
                {% endif %}
            </div>
        </div>
        <div class="task-actions">
            <a href="/tasks/{{ task.id }}" class="btn btn-sm">–û—Ç–∫—Ä—ã—Ç—å</a>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="empty-state">
        <p>–ó–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç</p>
        <a href="/tasks/new" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É</a>
    </div>
    {% endif %}
</div>
{% endblock %}
